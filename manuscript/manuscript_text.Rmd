---
title: "Palmer Archipelago (Antarctica) penguins: an alternative to Edgar Anderson's iris data"
output: html_document
bibliography: ../bibliography/references.bib
---

```{r setup, include=FALSE}
library(tidyverse)
library(here)
library(palmerpenguins)
library(kableExtra)
library(patchwork)
library(ggExtra)
library(gt)
library(ggpubr)
library(ggbeeswarm)
library(car)
knitr::opts_chunk$set(echo = TRUE)
```

## Authors

Allison Horst, Alison Hill, Kristen Gorman (order TBD)

## Keywords

## Abstract

Edgar Anderson's *Iris* data are ubiquitous in statistics and data science education, but their use in Ronald A. Fisher's eugenics research has created momentum to switch to alternative datasets. Size measurements for three penguin species observed on islands in Palmer Archipelago, Antarctica provide a (mostly) suitable, approachable and charismatic alternative to the *Iris* data. Here, we introduce the penguins data, then directly compare the two datasets to demonstrate that educators currently using *Iris* can switch to the Palmer Archipelago penguins for many use cases, particularly in introductory statistics and data science courses. 

## Introduction 

In 1935, American botanist Edgar Anderson measured petal and sepal dimensions (length and width) for 50 samples from three *Iris* species: *Iris setosa*, *Iris versicolor*, and *Iris virginica* [@anderson]. The manageable but non-trivial size (5 variables and 150 total observations) and characteristics of the data make it amenable for introducing a wide range of statistical methods including data wrangling, visualization, regression, classification and more. Anderson's *Iris* dataset is even built into a number of software packages, including in the auto-installed *datasets* package in *R* (R Core Team), Python's *scikit-learn* machine learning library [@scikit-learn], and the SAS *Sashelp* library, further facilitating its widespread use. As a result, eighty-five years after the data were initially published, Anderson’s Iris measurements are ubiquitous in statistics and data science education. 

*Sounds great. Why consider switching?*

In 1936, one year after publication in the *Bulletin of the American Iris Society*, Anderson’s *Iris* measurements were further analyzed and published by eugenicist and statistician Ronald A. Fisher in *The Annals of Eugenics* [@fisher]. Regardless of Anderson's initial motivation, the dataset today remains inextricably linked to Fisher’s eugenics research and even commonly (if unfairly) referred to as "*Fisher's* iris data" (ref). Due to its history in - and strong association with - Fisher's eugenics research, there is momentum to replace the *Iris* data with alternative datasets that offer similar teaching and learning opportunities.

Considering *Iris* data usage, we established the following criteria for a suitable alternative dataset: 

- Available by an appropriate license, ideally CC0 (no rights reserved)
- Feature intuitive subjects and variables understandable to learners across fields
- Manageable - but not trivial - in size
- Real-world (not manufactured) data for improved understanding and engagement [@cafe]
- Provide similar opportunities for teaching data science skills and statistical methods

Here, we offer an alternative to Anderson's *Iris* data that largely satisfies those criteria: an approachable and charismatic dataset containing real-world size measurements for three penguin species observed on islands in Palmer Archipelago, Antarctica. Comparable size, characteristics and learning opportunities make the penguins data uniquely transferable for educators currently using *Iris*. By highlighting similarities in data structure and analyses, as well as several examples for which the penguins are *not* a good alternative, we demonstrate that the penguins can replace irises for many use cases. 

## Data source

Size measurements, clutch observations, and blood isotope levels for male and female nesting adult Adélie (*Pygoscelis adeliae*), chinstrap (*Pygoscelis antarcticus*), and gentoo (*Pygoscelis papua*) penguins on three islands in the Palmer Archipelago were collected from 2007 - 2009 by Dr. Kristen Gorman with the [Palmer Station Long Term Ecological Research Program](https://pal.lternet.edu/), part of the [US Long Term Ecological Research Network](https://lternet.edu/). For complete data collection methods see [@gorman_plos]. The data were imported directly from the [Environmental Data Initiative](https://environmentaldatainitiative.org/) (EDI) Data Portal [@adelie_edi; @gentoo_edi; @chinstrap_edi] and are available for use by CC0 license ("No Rights Reserved") in accordance with the [Palmer Station Data Policy](https://pal.lternet.edu/data/policies). 

Data for each penguin species (Adélie, chinstrap and gentoo) were imported separately, then combined into a single table stored in the [*palmerpenguins*](https://allisonhorst.github.io/palmerpenguins/) package as object `penguins_raw`. Data in `penguins_raw` are in tidy format [@tidydata] and contain observations for 17 variables (Appendix Table 1) recorded completely or in part for 344 individual penguins. 

### Curated `penguins` data

As a direct alternative to Anderson's *Iris* data, we recommend using the curated `penguins` object in the **palmerpenguins** *R* data package. The `penguins` data is a subset of `penguins_raw` retaining all 344 rows (individual penguins) but reduced to the following seven variables: 

- **species:** a factor denoting the penguin species (Adelie, Chinstrap, or Gentoo)
- **island:** a factor denoting the island (in Palmer Archipelago, Antarctica) where observed (Biscoe, Dream or Torgersen)
- **bill_length_mm:** a number denoting length of the dorsal ridge of penguin bill (millimeters)
- **bill_depth_mm:** a number denoting the depth of the penguin bill (millimeters)
- **flipper_length_mm:** an integer denoting penguin flipper length (millimeters)
- **body_mass_g:** an integer denoting penguin body mass (grams)
- **sex:** a factor denoting penguin sex (male, female)

The `penguins` subset contains `r sum(complete.cases(penguins))` complete cases, with missing values (n~missing~ = `r sum(is.na(penguins))`, or `r round(100*sum(is.na(penguins))/(7*344),2)` % of all values) indicated by `NA` throughout. In addition to reduced variables, the curated `penguins` subset is minimally updated from `penguins_raw` as follows: 

1. All variable names are converted to lower snake case
2. Factor levels for species are truncated to only include the common name (e.g. "Gentoo", instead of "Gentoo penguin (*Pygoscelis papua*)")
3. Recorded sex for penguin N36A1, originally recorded as ".", is updated to `NA`
4. "culmen_length_mm" and "culmen_depth_mm" variable names are updated to "bill_length_mm" and "bill_depth_mm" to be more intuitive

## Selected comparisons: `penguins` and `iris`

We feel that the `penguins` data is generally useful and approachable for statistics education, and that it is uniquely well-suited to replace `iris`. Comparisons presented here are representative examples, and are not exhaustive. Additional examples and tutorials are shared in the [user-contributed examples](https://allisonhorst.github.io/palmerpenguins/articles/articles/user_contributions.html) article on the package website.  

### Structure and sample size 

Both `iris` and `penguins` datasets are in tidy format [@tidydata], with each column denoting a single variable and each row containing a single observation (Table 1, 2). 

```{r, echo = FALSE}
set.seed(1900)
sample_n(iris, 6) %>% 
  kable(caption = "Table 1. Iris dataset, 6 random observations (of 150 total)") %>% 
  kable_styling(full_width = FALSE)
```

```{r, echo = FALSE}
set.seed(1900)
sample_n(penguins, 6) %>% 
  kable(caption = "Table 2. Penguins dataset, 6 random observations (of 344 total)") %>% 
  kable_styling(full_width = FALSE)
```

Overall sizes are comparable: dimensions (# columns $\times$ # rows) are 5 $\times$ 150 and 7 $\times$ 344 for `iris` and `penguins`, respectively, and sample sizes within groups (e.g. by species) are similar (Table 3). Note that the additional factors in `penguins` (species, island and sex) create additional opportunities for grouping, compared to the single factor in `iris` (Species). 

```{r compare_counts, echo = FALSE}

iris_counts <- iris %>% 
  count(Species) %>% 
  rename(`Iris species` = Species)

penguin_counts <- penguins %>% 
  mutate(sex = str_to_title(sex)) %>% 
  rename(`Penguin species` = species) %>% 
  count(`Penguin species`, sex) %>% 
  pivot_wider(names_from = sex, values_from = n)

iris_penguin_n <- cbind(iris_counts, penguin_counts) %>% 
  rename(`Sample size` = n)

iris_penguin_n %>% 
  gt() %>% 
  tab_spanner(
    label = "Iris data",
    columns = vars(`Iris species`, `Sample size`)
  ) %>% 
  tab_spanner(
    label = "Penguin data",
    columns = vars(`Penguin species`, `Female`, `Male`, `NA`)
  ) %>% 
  tab_footnote(
    footnote = "Note: Here, penguin sample sizes are split by species and sex, and could be further divided by island.",
    location = cells_column_labels(
      columns = vars(`Penguin species`)
    )
  )
```

### Linear correlation & regression opportunities

#### Comparison 1: Linear trends across or within species

An overall approximately linear relationship can be explored using petal dimensions from `iris`, and penguin size (flipper length versus body mass) in `penguins` (Figure X). Educators may explore how linear regression across all species of iris or penguins (Figure X A,B) compares to regression performed separately for each species (Figure X C,D). 


```{r, echo = FALSE, warning = FALSE, message = FALSE}

penguin_flip_mass_scatter <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_point(aes(color = species, shape = species), size = 1.5, alpha = 0.7) +
  geom_smooth(method = "lm", aes(group = species, color = species), se = FALSE) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = c(0.3, 0.8)) +
  labs(x = "Flipper length (mm)", 
       y = "Body mass (g)") +
  theme(plot.title.position = "plot")

penguin_flip_mass_scatter_all <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_point(color = "gray50", size = 1.5, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  theme_minimal() +
  labs(x = "Flipper length (mm)", 
       y = "Body mass (g)",
       title = "Penguin size") +
  theme(plot.title.position = "plot")

iris_petal_scatter <- ggplot(iris, aes(x = Petal.Length, y = Petal.Width)) +
  geom_point(aes(color = Species, size = Species, shape = Species), size = 1.5, alpha = 0.7) +
  geom_smooth(aes(group = Species, color = Species), method = "lm", se = FALSE) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = c(0.3, 0.8)) +
  labs(x = "Petal length (cm)",
       y = "Petal width (cm)") +
  theme(plot.title.position = "plot")

iris_petal_scatter_all <- ggplot(iris, aes(x = Petal.Length, y = Petal.Width)) +
  geom_point(color = "gray50", size = 1.5, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  theme_minimal() +
  labs(x = "Petal length (cm)",
       y = "Petal width (cm)",
       title = "Iris petal dimensions") +
  theme(plot.title.position = "plot")

(penguin_flip_mass_scatter_all + iris_petal_scatter_all) / (penguin_flip_mass_scatter + iris_petal_scatter)

ggsave(here("figures","iris_penguins_scatter.png"), height = 6, width = 6)
```

#### Comparison 2: linear relationships within species

More obvious clustering (by penguin species) exists when comparing bill length and depth (Figure X), and the relationship also provides an opportunity to introduce & explore Simpson's Paradox. 

```{r, echo = FALSE, warning = FALSE, message = FALSE}
penguin_bill_scatter <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species), size = 2, alpha = 0.7) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = "bottom") +
  labs(x = "Bill length (mm)", 
       y = "Bill depth (g)",
       title = "Penguin size", 
       color = "Species") +
  theme(plot.title.position = "plot")

iris_sepal_scatter <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  geom_point(aes(color = Species), size = 2, alpha = 0.7) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = "bottom") +
  labs(x = "Sepal length (cm)",
       y = "Sepal width (cm)",
       title = "Iris sepal dimensions") +
  theme(plot.title.position = "plot")

penguin_bill_scatter + iris_sepal_scatter
```



### Differences between groups 

As in `iris`, multiple opportunities for comparisons between groups also exist in `penguins` (Figure X). Notably, more obvious separation between species exists in `iris` (Figure X E & F), compared to any between-species comparisons in `penguins` (Figure X A - D). 

```{r, include = FALSE}

# CHECK THIS ALL!!! 
# ANOVA to see if flipper lengths are significantly different...(this says yes, but want other eyes)
flipper_lm <- lm(flipper_length_mm ~ species, data = penguins)

flipper_anova <- Anova(flipper_lm, type = "III")
flipper_anova

flip_aov <- aov(flipper_lm)
summary(flip_aov)

# TukeyHSD(flip_aov) all significantly different

```


```{r, echo = FALSE, warning = FALSE, message = FALSE}

# Update this with an actual theme FFS and use '&' in patchwork

iris_pw <- ggplot(iris, aes(x = Species, y = Petal.Width)) +
  geom_boxplot(aes(color = Species),
               show.legend = FALSE) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_bw() +
  theme(plot.title.position = "plot") +
  labs(x = "",
       y = "Petal width (cm)") +
  coord_flip()

iris_pl <- ggplot(iris, aes(x = Species, y = Petal.Length)) +
  geom_boxplot(aes(color = Species),
               show.legend = FALSE) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_bw() +
  theme(plot.title.position = "plot") +
  labs(x = "",
       y = "Petal length (cm)") +
  coord_flip()

iris_sl <- ggplot(iris, aes(x = Species, y = Sepal.Length)) +
  geom_boxplot(aes(color = Species),
               show.legend = FALSE) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_bw() +
  theme(plot.title.position = "plot") +
  labs(x = "",
       y = "Sepal length (cm)") +
  coord_flip()

iris_sw <- ggplot(iris, aes(x = Species, y = Sepal.Width)) +
  geom_boxplot(aes(color = Species),
               show.legend = FALSE) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_bw() +
  theme(plot.title.position = "plot") +
  labs(x = "",
       y = "Sepal width (cm)") +
  coord_flip()

penguins_flip <- penguins %>%
  ggplot(aes(x = species, y = flipper_length_mm)) +
  geom_boxplot(aes(color = species),
               show.legend = FALSE) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_bw() +
  labs(x = "",
       y = "Flipper length (mm)") +
  coord_flip()

penguins_mass <- penguins %>%
  ggplot(aes(x = species, y = body_mass_g)) +
  geom_boxplot(aes(color = species),
               show.legend = FALSE) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_bw() +
  labs(x = "",
       y = "Body mass (g)") +
  coord_flip()

penguins_bill_length <- penguins %>%
  ggplot(aes(x = species, y = bill_length_mm)) +
  geom_boxplot(aes(color = species),
               show.legend = FALSE) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_bw()+
  labs(x = "",
       y = "Bill length (mm)") +
  coord_flip()

penguins_bill_depth <- penguins %>%
  ggplot(aes(x = species, y = bill_depth_mm)) +
  geom_boxplot(aes(color = species),
               show.legend = FALSE) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_bw() +
  labs(x = "",
       y = "Bill depth (mm)") +
  coord_flip()

penguins_box <- penguins_flip / penguins_mass / penguins_bill_length / penguins_bill_depth + plot_layout(guides = "collect") + plot_annotation(title = "Penguins")

iris_box <- iris_pw / iris_pl / iris_sw / iris_sl + plot_layout(guides = "collect")

penguins_box | iris_box + plot_annotation(
  title = 'Penguin and iris sizes',
  subtitle = 'Penguin size measurements (left) and iris petal and sepal dimensions (right)',
  tag_levels = 'A'
)

ggsave(here("figures","penguins_iris_box.png"), height = 7, width = 8)

```

### Hypothesis testing

### Principle components analysis

### Clustering (e.g. k-means?)

### Classification (Alison Hill blog post?)

## Penguin data access for non-R users

The Palmer Archipelago penguins data are available to non-R users by direct import from the Environmental Data Initiative, from GitHub, and as a stored dataset in existing packages. Below we share several current ways to access the data (as of July 2020 - we expect availability to expand in the future).

### Download or import directly from Environmental Data Initiative

The [Environmental Data Initiative](https://environmentaldatainitiative.org/) is "an NSF-funded project, actively promoting and enabling curation and re-use of environmental data." The raw data for each penguin species (Adélie, Gentoo and Chinstrap) are stored in a separate data file at the following links (see full citations in Citations):

- Adélie data: [KNB-LTER Data Package 219.5](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-pal.219.5)
- Gentoo data: [KNB-LTER Data Package 220.5](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-pal.220.5)
- Chinstrap data: [KNB-LTER Data Package 221.5](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-pal.221.6)

The links above contain all metadata information, and provides options to directly download the data as a comma-separated value (CSV) file *or* import for use directly using code provided (e.g. for R, Python, SAS, MatLab, or SPSS). 

### Download CSV from the palmerpenguins GitHub repo

A CSV containing curated data for all three species (accessed directly from EDI) exists in the 'data-raw' folder in the palmerpenguins repo on GitHub. GitHub users can fork / clone the repo, and will then have the cleaned CSV containing all 3 penguin species. 

### The penguins in other packages & languages

The Palmer Station penguin data has been added to existing libraries, including (non-exhaustive): 

#### Python modules

- Seaborn
- blah blah

See examples for working with penguins in Python here: 



#### Kaggle

- here 

#### Elsewhere? 

## Conclusion


## Appendix

### Appendix A: Variables in the raw data

- **studyName:** Sampling expedition indicator
- **Sample Number:** Integer denoting the continuous numbering sequence for each penguin
- **Species:** a factor denoting the penguin species (Adelie, Chinstrap, or Gentoo)
- **Region**: A character denoting the region of the Palmer LTER sampling grid
- **Island:** a factor denoting the island where observed (Torgersen, Dream or Biscoe) in Palmer Archipelago
- **Stage:** A character string denoting reproductive stage at sampling
- **Individual ID:** A character string denoting a unique ID for each penguin
- **Clutch Completion:** A character string denoting if the study next observed with a full clutch, i.e. 2 eggs
- **Date Egg:** A date denoting the date study nest observed with 1 egg
- **Culmen Length:** A number denoting the length of the dorsal ridge of a bird's bill (millimeters)
- **Culmen Depth:** A number denoting the depth of the dorsal ridge of a bird's bill (millimeters)
- **Flipper Length:** An integer denoting the penguin flipper length (millimeters)
- **Body Mass:** An integer denoting the penguin body mass (grams)
- **Sex:** A character string denoting the sex of an animal
- **Delta 15 N:** A number denoting the measure of the ratio of stable isotopes 15N:14N
- **Delta 13 C:** A number denoting the measure of the ratio of stable isotopes 13C:12C
- **Comments:** A character string with text providing additional relevant information for data





# Random other stuff

Compared to the single factor in `iris` (Species), `penguins`' three factors (species, island, sex) increase opportunities for comparisons between groups (Figure X).

```{r, echo = FALSE, warning = FALSE, message = FALSE}

cd <- penguins %>% 
  filter(sex %in% c("male","female")) %>% 
ggplot(aes(x = bill_depth_mm)) +
  geom_histogram(aes(fill = species), alpha = 0.6, position = "identity") +
  scale_fill_manual(values = c("darkorange","darkorchid","cyan4")) +
  facet_wrap(~ sex) +
  theme_minimal()

cl <- penguins %>% 
  filter(sex %in% c("male","female")) %>% 
ggplot(aes(x = bill_length_mm)) +
  geom_histogram(aes(fill = species), alpha = 0.6, position = "identity") +
  scale_fill_manual(values = c("darkorange","darkorchid","cyan4")) +
  facet_wrap(~ sex) +
  theme_minimal()

fl <- penguins %>% 
  filter(sex %in% c("male","female")) %>% 
ggplot(aes(x = flipper_length_mm)) +
  geom_histogram(aes(fill = species), alpha = 0.6, position = "identity") +
  scale_fill_manual(values = c("darkorange","darkorchid","cyan4")) +
  facet_wrap(~ sex) +
  theme_minimal()

bm <- penguins %>% 
  filter(sex %in% c("male","female")) %>% 
ggplot(aes(x = body_mass_g)) +
  geom_histogram(aes(fill = species), alpha = 0.6, position = "identity") +
  scale_fill_manual(values = c("darkorange","darkorchid","cyan4")) +
  facet_wrap(~ sex) +
  theme_minimal()

cd / cl / fl / bm + plot_layout(guides = "collect")
```

## Differences by islands? 

```{r}
# No difference in Adelie across islands: Chinstrap only on Dream, Gentoo only on Torgerson
penguins %>% 
  ggplot(aes(x = island, y = body_mass_g)) +
  geom_point() +
  facet_wrap(~species)

penguins %>% 
  ggplot(aes(x = island, y = flipper_length_mm)) +
  geom_point() +
  facet_wrap(~species)

penguins %>% 
  ggplot(aes(x = island, y = bill_length_mm)) +
  geom_point() +
  facet_wrap(~species)

penguins %>% 
  ggplot(aes(x = island, y = bill_depth_mm)) +
  geom_point() +
  facet_wrap(~species)
```

A Web of Science search reveals that Fisher's 1936 paper has been cited in 7,258 publications (as of June 2020), most often in journals publishing in fields of Computer Science (57% of 7,258 citing references), Mathematics (49%), and Engineering (29%) - most of which we expect are crediting Anderson's *Iris* data, and not Fisher's eugenics work. 

# End random other stuff

## Citations
