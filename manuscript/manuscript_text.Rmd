---
title: "Palmer Archipelago (Antarctica) penguins: an alternative to Edgar Anderson's iris data"
output: html_document
bibliography: ../bibliography/references.bib
---

```{r setup, include=FALSE}
library(tidyverse)
library(palmerpenguins)
library(kableExtra)
library(patchwork)
library(ggExtra)
library(gt)
library(ggpubr)
library(ggbeeswarm)
knitr::opts_chunk$set(echo = TRUE)
```

## Authors

Allison Horst, Alison Hill, Kristen Gorman

## Keywords

## Abstract

Edgar Anderson's *Iris* data are ubiquitous in statistics and data science education, but their use in Ronald A. Fisher's eugenics research has created momentum to switch to alternative datasets. Size measurements for three penguin species observed on islands in Palmer Archipelago, Antarctica provide a (mostly) suitable, approachable and charismatic alternative to the *Iris* data. Here, we introduce the penguins data, then directly compare the two datasets to demonstrate that educators currently using *Iris* can switch to the Palmer Archipelago penguins for many use cases, particularly in introductory statistics and data science courses. 

## Introduction 

In 1935, American botanist Edgar Anderson measured petal and sepal dimensions (length and width) for 50 samples from three *Iris* species: *Iris setosa*, *Iris versicolor*, and *Iris virginica* [@anderson]. The manageable but non-trivial size (5 variables and 150 total observations) and characteristics of the data (....SOMETHING HERE) make it amenable for introducing a wide range of statistical methods including data wrangling, visualization, hypothesis testing, regression, machine learning, and more. Anderson's *Iris* dataset is even built into a number of software packages, including in the auto-installed *datasets* package in *R*, Python's *scikit-learn* machine learning library, and the SAS *Sashelp* library, further facilitating its widespread use. As a result, eighty-five years after the data were initially published, Anderson’s Iris measurements are ubiquitous in statistics and data science materials. 

*Sounds great. Why consider switching?*

In 1936, one year after its publication in the *Bulletin of the American Iris Society*, Anderson’s *Iris* measurements were further analyzed and published by eugenicist and statistician Ronald A. Fisher in *The Annals of Eugenics* [@fisher]. Regardless of Anderson's initial motivation, the dataset today inextricably linked to Fisher’s eugenics research and even commonly (if unfairly) referred to as "*Fisher's* iris data" (ref). Due to its history in - and association with - Fisher's eugenics research, there is momentum to replace Iris with alternative datasets that offer similar teaching and learning opportunities.

Considering *Iris* usage, we established the following criteria for a suitable alternative dataset: 

- Available by an appropriate license, ideally CC0 (no rights reserved)
- Should feature intuitive subjects and variables that are understandable to learners across fields
- Dimensions should be manageable (but not trivial)
- Contain real-world observations for improved understanding and engagement [@cafe]
- Provide similar opportunities for teaching data science skills and statistical methods

Here, we offer an alternative to Anderson's irises that largely satisfies those criteria: an approachable and charismatic dataset containing real-world size measurements for three penguin species observed on islands in Palmer Archipelago, Antarctica. Comparable size, characteristics and learning opportunities make the penguins data uniquely transferable for educators currently using *Iris*. By highlighting similarities in data structure and analyses, as well as several examples for which the penguins are *not* a good alternative, we demonstrate that the penguins can replace irises for many use cases. 

## Data source

Size measurements, clutch observations, and blood isotope levels for male and female nesting adult Adélie (*Pygoscelis adeliae*), chinstrap (*Pygoscelis antarcticus*), and gentoo (*Pygoscelis papua*) penguins on three islands in the Palmer Archipelago were collected from 2007 - 2009 by Dr. Kristen Gorman with the [Palmer Station Long Term Ecological Research Program](https://pal.lternet.edu/), part of the [US Long Term Ecological Research Network](https://lternet.edu/). For complete data collection methods see [@gorman_plos]. The data were imported directly from the [Environmental Data Initiative](https://environmentaldatainitiative.org/) (EDI) Data Portal [@adelie_edi; @gentoo_edi; @chinstrap_edi] and are available for use by CC0 license ("No Rights Reserved") in accordance with the [Palmer Station Data Policy](https://pal.lternet.edu/data/policies). 

Data for each penguin species (Adélie, chinstrap and gentoo) were imported separately, then combined into a single table stored in the [*palmerpenguins*](https://allisonhorst.github.io/palmerpenguins/) package as object `penguins_raw`. Data in `penguins_raw` are in tidy format [@tidydata] and contain observations for 17 variables (Appendix Table 1) recorded completely or in part for 344 individual penguins. 

### Curated `penguins` data

As a direct alternative to Anderson's *Iris* data, we recommend using the curated `penguins` object in the *palmerpenguins* data package. The `penguins` data is a subset of `penguins_raw` retaining all 344 rows (individual penguins) but reduced to the following seven variables: 

- **species:** a factor denoting the penguin species (Adelie, Chinstrap, or Gentoo)
- **island:** a factor denoting the island (in Palmer Archipelago, Antarctica) where observed (Biscoe, Dream or Torgersen)
- **bill_length_mm:** a number denoting length of the dorsal ridge of penguin bill (millimeters)
- **bill_depth_mm:** a number denoting the depth of the penguin bill (millimeters)
- **flipper_length_mm:** an integer denoting penguin flipper length (millimeters)
- **body_mass_g:** an integer denoting penguin body mass (grams)
- **sex:** a factor denoting penguin sex (male, female)

The `penguins` subset contains `r sum(complete.cases(penguins))` complete cases, with missing values (n~missing~ = `r sum(is.na(penguins))`) indicated by `NA` throughout. In addition to reduced variables, the curated `penguins` subset is minimally updated from `penguins_raw` as follows: 

1. All variable names are converted to lower snake case
2. Factor levels for species are truncated to only include the common name (e.g. "Gentoo", instead of "Gentoo penguin (*Pygoscelis papua*)")
3. Recorded sex for penguin N36A1, originally recorded as ".", is updated to `NA`
4. "culmen_length_mm" and "culmen_depth_mm" variable names are updated to "bill_length_mm" and "bill_depth_mm" to be more intuitive

## Selected comparisons: `penguins` and `iris`

We feel that the `penguins` data is generally useful and approachable for statistics education, and that it is uniquely well-suited to replace `iris`. Comparisons presented here are representative examples, and are not exhaustive. 

### Structure and sample size 

Both `iris` and `penguins` datasets are tidy [@tidydata], with each column denoting a single variable and each row containing a single observation (Table 1, 2). 

```{r, echo = FALSE}
set.seed(1900)
sample_n(iris, 6) %>% 
  kable(caption = "Table 1. Iris dataset, 6 random observations (of 150 total)") %>% 
  kable_styling(full_width = FALSE)
```

```{r, echo = FALSE}
set.seed(1900)
sample_n(penguins, 6) %>% 
  kable(caption = "Table 2. Penguins dataset, 6 random observations (of 344 total)") %>% 
  kable_styling(full_width = FALSE)
```

Overall sizes are comparable: dimensions (# columns $\times$ # rows) are 5 $\times$ 150 and 7 $\times$ 344 for `iris` and `penguins`, respectively, and sample sizes within groups (e.g. by species) are similar (Table 3). 

```{r compare_counts, echo = FALSE}

iris_counts <- iris %>% 
  count(Species) %>% 
  rename(`Iris species` = Species)

penguin_counts <- penguins %>% 
  mutate(sex = str_to_title(sex)) %>% 
  rename(`Penguin species` = species) %>% 
  count(`Penguin species`, sex) %>% 
  pivot_wider(names_from = sex, values_from = n)

iris_penguin_n <- cbind(iris_counts, penguin_counts) %>% 
  rename(`Sample size` = n)

iris_penguin_n %>% 
  gt() %>% 
  tab_spanner(
    label = "Iris data",
    columns = vars(`Iris species`, `Sample size`)
  ) %>% 
  tab_spanner(
    label = "Penguin data",
    columns = vars(`Penguin species`, `Female`, `Male`, `NA`)
  ) %>% 
  tab_footnote(
    footnote = "Note: Here, penguin sample sizes are split by species and sex, and could be further divided by island.",
    location = cells_column_labels(
      columns = vars(`Penguin species`)
    )
  )
```

### Correlation

#### Comparison 1: Linear trends across or within species

An overall approximately linear relationship can be explored using petal dimensions from `iris`, and penguin size (flipper length versus body mass) in `penguins` (Figure X). Educators may explore how linear regression across all species of iris or penguins compares to regression performed separately for each species. 


```{r, echo = FALSE, warning = FALSE}

penguin_flip_mass_scatter <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_point(aes(color = species), size = 2, alpha = 0.7) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = c(0.3, 0.8)) +
  labs(x = "Flipper length (mm)", 
       y = "Body mass (g)",
       title = "Penguin size") +
  theme(plot.title.position = "plot")

iris_petal_scatter <- ggplot(iris, aes(x = Petal.Length, y = Petal.Width)) +
  geom_point(aes(color = Species), size = 2, alpha = 0.7) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = c(0.3, 0.8)) +
  labs(x = "Petal length (cm)",
       y = "Petal width (cm)",
       title = "Iris petal dimensions") +
  theme(plot.title.position = "plot")

penguin_flip_mass_scatter + iris_petal_scatter
```

#### Comparison 2: linear relationships within species

```{r, echo = FALSE, warning = FALSE, message = FALSE}
penguin_bill_scatter <- ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(aes(color = species), size = 2, alpha = 0.7) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = "bottom") +
  labs(x = "Bill length (mm)", 
       y = "Bill depth (g)",
       title = "Penguin size", 
       color = "Species") +
  theme(plot.title.position = "plot")

iris_sepal_scatter <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  geom_point(aes(color = Species), size = 2, alpha = 0.7) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = "bottom") +
  labs(x = "Sepal length (cm)",
       y = "Sepal width (cm)",
       title = "Iris sepal dimensions") +
  theme(plot.title.position = "plot")

penguin_bill_scatter + iris_sepal_scatter
```



### Differences between groups 

As in `iris`, multiple opportunities for comparisons between groups also exist in `penguins`. 

```{r, echo = FALSE, warning = FALSE, message = FALSE}

iris_bee <- ggplot(iris, aes(x = Species, y = Petal.Width)) +
  geom_boxplot(color = "gray80",
               fill = "gray92", 
               outlier.color = NA
               ) +
  geom_beeswarm(aes(color = Species), 
                alpha = 0.6,
                size = 2) + 
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_minimal() +
  theme(legend.position = c(0.2, 0.8),
        plot.title.position = "plot") +
  labs(x = "Iris species",
       y = "Petal width (cm)",
       title = "Iris petal width")

fpenguins_bee <- penguins %>% 
  ggplot(aes(x = species, y = flipper_length_mm)) +
  geom_boxplot(color = "gray80",
               fill = "gray92", 
               outlier.color = NA
               ) +
  geom_beeswarm(aes(color = species), 
                alpha = 0.6,
                size = 2) + 
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_minimal() +
  theme(legend.position = c(0.2, 0.8),
        plot.title.position = "plot") +
  labs(x = "Penguin species",
       y = "Flipper length (mm)",
       title = "Penguin flipper length")

fpenguins_bee + iris_bee
```

Compared to the single factor in `iris` (Species), `penguins`' three factors (species, island, sex) increase opportunities for comparisons between groups (Figure X).

```{r, echo = FALSE, warning = FALSE, message = FALSE}

cd <- penguins %>% 
  filter(sex %in% c("male","female")) %>% 
ggplot(aes(x = bill_depth_mm)) +
  geom_histogram(aes(fill = species), alpha = 0.6, position = "identity") +
  scale_fill_manual(values = c("darkorange","darkorchid","cyan4")) +
  facet_wrap(~ sex) +
  theme_minimal()

cl <- penguins %>% 
  filter(sex %in% c("male","female")) %>% 
ggplot(aes(x = bill_length_mm)) +
  geom_histogram(aes(fill = species), alpha = 0.6, position = "identity") +
  scale_fill_manual(values = c("darkorange","darkorchid","cyan4")) +
  facet_wrap(~ sex) +
  theme_minimal()

fl <- penguins %>% 
  filter(sex %in% c("male","female")) %>% 
ggplot(aes(x = flipper_length_mm)) +
  geom_histogram(aes(fill = species), alpha = 0.6, position = "identity") +
  scale_fill_manual(values = c("darkorange","darkorchid","cyan4")) +
  facet_wrap(~ sex) +
  theme_minimal()

bm <- penguins %>% 
  filter(sex %in% c("male","female")) %>% 
ggplot(aes(x = body_mass_g)) +
  geom_histogram(aes(fill = species), alpha = 0.6, position = "identity") +
  scale_fill_manual(values = c("darkorange","darkorchid","cyan4")) +
  facet_wrap(~ sex) +
  theme_minimal()

cd / cl / fl / bm + plot_layout(guides = "collect")
```



#### Comparison 3: Principal components analysis

## Appendix

### Appendix A: Variables in the raw data

- **studyName:** Sampling expedition indicator
- **Sample Number:** Integer denoting the continuous numbering sequence for each penguin
- **Species:** a factor denoting the penguin species (Adelie, Chinstrap, or Gentoo)
- **Region**: A character denoting the region of the Palmer LTER sampling grid
- **Island:** a factor denoting the island where observed (Torgersen, Dream or Biscoe) in Palmer Archipelago
- **Stage:** A character string denoting reproductive stage at sampling
- **Individual ID:** A character string denoting a unique ID for each penguin
- **Clutch Completion:** A character string denoting if the study next observed with a full clutch, i.e. 2 eggs
- **Date Egg:** A date denoting the date study nest observed with 1 egg
- **Culmen Length:** A number denoting the length of the dorsal ridge of a bird's bill (millimeters)
- **Culmen Depth:** A number denoting the depth of the dorsal ridge of a bird's bill (millimeters)
- **Flipper Length:** An integer denoting the penguin flipper length (millimeters)
- **Body Mass:** An integer denoting the penguin body mass (grams)
- **Sex:** A character string denoting the sex of an animal
- **Delta 15 N:** A number denoting the measure of the ratio of stable isotopes 15N:14N
- **Delta 13 C:** A number denoting the measure of the ratio of stable isotopes 13C:12C
- **Comments:** A character string with text providing additional relevant information for data


## Citations
