---
title: 'Palmer Archipelago (Antarctica) penguins: an alternative to Edgar Anderson''s
  iris data'
output:
  html_document:
    number_sections: yes
  pdf_document: default
bibliography: ../bibliography/references.bib
---

```{r setup, include=FALSE}
library(tidyverse)
library(here)
library(palmerpenguins)
library(kableExtra)
library(patchwork)
library(gt)
library(GGally)
library(recipes)
library(shadowtext)
knitr::opts_chunk$set(echo = TRUE)

theme_set(theme_minimal())
```

# Authors (placeholder order TBD)

Allison Horst^1^, Alison Hill^2^, Kristen Gorman^3^ 

^1^ Bren School of Environmental Science and Management, University of California, Santa Barbara

^2^ RStudio

^3^ College of Fisheries and Ocean Sciences, University of Alaska Fairbanks

# Keywords

Multivariate analysis, cluster analysis, correlation, classification, zoology, penguin morphology

# Abstract

Edgar Anderson's *Iris* data are ubiquitous in statistics and data science education, but their use in Ronald A. Fisher's eugenics research has created momentum to switch to alternative datasets. Size measurements for three penguin species observed on islands in Palmer Archipelago, Antarctica provide a suitable, approachable and charismatic alternative to the *Iris* data. Here, we introduce the penguin data, then directly compare the two datasets to demonstrate that educators currently using *Iris* can switch to the Palmer Archipelago penguins for many use cases including data wrangling and visualization, correlation, regression, multivariate analysis (e.g. PCA), cluster analysis and classification (e.g. by k-means). 

# Introduction 

In 1935, American botanist Edgar Anderson measured petal and sepal dimensions (length and width) for 50 samples from three *Iris* species: *Iris setosa*, *Iris versicolor*, and *Iris virginica* [@anderson]. The manageable but non-trivial size (5 variables and 150 total observations) and characteristics of the data make it amenable for introducing a wide range of statistical methods including data wrangling, visualization, regression, cluster analysis, machine learning, and more. Anderson's *Iris* dataset is even built into a number of software packages, including in the auto-installed *datasets* package in *R* (R Core Team), Python's *scikit-learn* machine learning library [@scikit-learn], and the SAS *Sashelp* library, further facilitating its widespread use. As a result, eighty-five years after the data were initially published, Anderson’s *Iris* measurements are ubiquitous in statistics and data science education. 

*Sounds great. Why consider switching?*

In 1936, one year after publication in the *Bulletin of the American Iris Society*, Anderson’s *Iris* measurements were further analyzed and published by eugenicist and statistician Ronald A. Fisher in *Annals of Eugenics* [@fisher]. Regardless of Anderson's initial motivation, the data today remain inextricably linked to Fisher’s eugenics research and are even commonly (if unfairly) referred to as "*Fisher's* iris data". Due to its history in - and strong association with - Fisher's work, there is momentum for teachers to (1) address the history of the *Iris* data in eugenics research when teaching with it, or (2) replace the *Iris* data with an alternative dataset that offers similar teaching and learning opportunities. This paper focuses on (2): a replacement for the *Iris* data. 

Considering *Iris* data usage in statistics education, we established the following criteria for a suitable replacement dataset: 

- Available by an appropriate license, ideally CC0 (no rights reserved)
- Feature intuitive subjects and variables understandable to learners across fields
- Manageable - but not trivial - in size
- Real-world (not manufactured) data for improved understanding and engagement [@cafe]
- Provide similar opportunities for teaching data science skills and statistical methods

Here, we offer an alternative to Anderson's *Iris* data that largely satisfies those criteria: an approachable and charismatic dataset containing real-world size measurements for three penguin species observed on islands in Palmer Archipelago, Antarctica. Comparable size, characteristics and learning opportunities make the penguins data uniquely transferable for educators currently using *Iris*. By comparing data structure, size, and a range of analyses side-by-side, we demonstrate that the Palmer Archipelago penguin measurements can replace Anderson's iris data for many use cases. 

# Data source

Size measurements, clutch observations, and blood isotope levels for male and female nesting adult Adélie (*Pygoscelis adeliae*), chinstrap (*Pygoscelis antarcticus*), and gentoo (*Pygoscelis papua*) penguins on three islands in the Palmer Archipelago were collected from 2007 - 2009 by Dr. Kristen Gorman with the [Palmer Station Long Term Ecological Research Program](https://pal.lternet.edu/), part of the [US Long Term Ecological Research Network](https://lternet.edu/). For complete data collection methods and published analyses see [@gorman_plos]. 

Data were imported from the [Environmental Data Initiative](https://environmentaldatainitiative.org/) (EDI) Data Portal [@adelie_edi; @gentoo_edi; @chinstrap_edi](see description below), and are generously available for use by CC0 license ("No Rights Reserved") in accordance with the [Palmer Station Data Policy](https://pal.lternet.edu/data/policies) and the [LTER Data Access Policy](https://lternet.edu/data-access-policy/) for Type I data. 

# How to get the Palmer Archipelago penguin data

The combined raw data for all three penguin species (penguins_raw.csv) and the curated penguin data (penguins.csv), which are identical to the `penguins_raw` and `penguins` data objects in the **palmerpenguins** *R* package described below, are available for download from the Journal of Statistics Education site. The data can be also accessed through EDI directly, or via existing packages for different programming languages. Options included here are based on availability as of July 2020, and may be updated or deleted by package maintainers. 

## Download or import from EDI

The raw data for each penguin species (Adélie, Gentoo and Chinstrap) are stored in a separate data package, accessed through the EDI repository:

- Adélie data: [KNB-LTER Data Package 219.5](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-pal.219.5)
- Gentoo data: [KNB-LTER Data Package 220.5](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-pal.220.5)
- Chinstrap data: [KNB-LTER Data Package 221.5](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-pal.221.6)

The links above contain all metadata information, and provides options to directly download the data as a comma-separated value (CSV) file *or* import for use directly using code provided (e.g. for R, Python, SAS, MatLab, or SPSS). 

## R: **palmerpenguins** package and GitHub repo

For easier data access and use in *R*, we created the [**palmerpenguins**](https://allisonhorst.github.io/palmerpenguins/) data package. *R* users can install the development version of the package using: 

```
library(remotes)
remotes::install_github("allisonhorst/palmerpenguins")
```

The **palmerpenguins** package contains two data objects, described below: 

- `penguins_raw`: a table containing all raw data 
- `penguins`: a simplified table containing only size measurements, sex, island and species 

### Raw data: `penguins_raw` 

Data for each penguin species (Adélie, chinstrap and gentoo) were imported from EDI, then the raw data were combined into a single table stored in the [*palmerpenguins*](https://allisonhorst.github.io/palmerpenguins/) package as object `penguins_raw`. Data in `penguins_raw` are in tidy format [@tidydata] and contain observations for 17 variables (Appendix Table 1) recorded completely or in part for 344 individual penguins. For full variable descriptions and metadata, visit the data packages through EDI.

### Curated `penguins` data

As a direct alternative to Anderson's *Iris* data, we recommend using the curated `penguins` object in the **palmerpenguins** *R* data package. The `penguins` data is a subset of `penguins_raw` retaining all 344 rows (individual penguins) but reduced to the following seven variables: 

- **species:** a factor denoting the penguin species (Adelie, Chinstrap, or Gentoo)
- **island:** a factor denoting the island (in Palmer Archipelago, Antarctica) where observed (Biscoe, Dream or Torgersen)
- **bill_length_mm:** a number denoting length of the dorsal ridge of penguin bill (millimeters)
- **bill_depth_mm:** a number denoting the depth of the penguin bill (millimeters)
- **flipper_length_mm:** an integer denoting penguin flipper length (millimeters)
- **body_mass_g:** an integer denoting penguin body mass (grams)
- **sex:** a factor denoting penguin sex (male, female)

The `penguins` subset contains `r sum(complete.cases(penguins))` complete cases, with missing values (n~missing~ = `r sum(is.na(penguins))`, or `r round(100*sum(is.na(penguins))/(7*344),2)` % of all values) indicated by `NA` throughout. In addition to reduced variables, the curated `penguins` subset is minimally updated from `penguins_raw` as follows: 

1. All variable names are converted to lower snake case
2. Factor levels for species are truncated to only include the common name (e.g. "Gentoo", instead of "Gentoo penguin (*Pygoscelis papua*)")
3. Recorded sex for penguin N36A1, originally recorded as ".", is updated to `NA`
4. "culmen_length_mm" and "culmen_depth_mm" variable names are updated to "bill_length_mm" and "bill_depth_mm" to be more intuitive

The package repository on GitHub also contains a comma separated value (CSV) file containing the curated `penguins` data. Users can access and import the penguins.csv file directly from the data-raw/ folder in the repository: 

## Penguins in other computing languages:

### Python: `seaborn` data vizualization library

### Julia: `PalmerPenguins.jl` package

# Selected comparisons: `penguins` and `iris`

We feel that the `penguins` dataset in the **palmerpenguins** *R* package is generally useful and approachable for statistics education, and that it is uniquely well-suited to replace `iris`. Comparisons presented here between `penguins` and `iris` are select examples for common `iris` uses in statistics education, and are not exhaustive. 

## Structure and sample size 

Both `iris` and `penguins` datasets are in tidy format [@tidydata], with each column denoting a single variable and each row containing a single observation (Table 1, 2). 

```{r, echo = FALSE}
set.seed(1900)
sample_n(iris, 6) %>% 
  kable(caption = "Table 1. Iris dataset, 6 random observations (of 150 total)") %>% 
  kable_styling(full_width = FALSE)
```

```{r, echo = FALSE}
set.seed(1900)
sample_n(penguins, 6) %>% 
  kable(caption = "Table 2. Penguins dataset, 6 random observations (of 344 total)") %>% 
  kable_styling(full_width = FALSE)
```

Overall sizes are comparable: dimensions (# columns $\times$ # rows) are 5 $\times$ 150 and 7 $\times$ 344 for `iris` and `penguins`, respectively, and sample sizes within groups (e.g. by species) are similar (Table 3). Notably, sample sizes differ for the three penguin species, while sample sizes are equal in `iris`, and multiple factors in `penguins` (species, island and sex) create additional opportunities for grouping, compared to the single species factor in `iris`. We feel that the presence of missing values and unequal sample sizes in `penguins` creates opportunities for data exploration and analyses that are closer to what students might expect for data "in the wild."

```{r compare_counts, echo = FALSE}

iris_counts <- iris %>% 
  count(Species) %>% 
  rename(`Iris species` = Species)

penguin_counts <- penguins %>% 
  mutate(sex = str_to_title(sex)) %>% 
  group_by(species, sex) %>% 
  tally() %>% 
  pivot_wider(names_from = sex, values_from = n) %>% 
  replace_na(list(`NA` = 0)) %>% 
  as.data.frame() %>% 
  rename(`Penguin species` = species)


iris_penguin_n <- cbind(iris_counts, penguin_counts) %>% 
  rename(`Sample size` = n)

iris_penguin_n %>%
  gt() %>%
  tab_spanner(
    label = "Iris sample size (by species)",
    columns = vars(`Iris species`, `Sample size`)
  ) %>%
  tab_spanner(
    label = "Penguin sample size (by species and sex)",
    columns = vars(`Penguin species`, `Female`, `Male`, `NA`)
  ) %>%
  tab_footnote(
    footnote = "Note: Here, penguin sample sizes are split by species and sex, and could be further divided by island. NA column for penguins indicate observations where sex was not recorded.",
    location = cells_column_labels(
      columns = vars(`Penguin species`)
    )
  )

```

## Overview comparison: numeric variables

Distributions and relationships between variables and groups can be similarly explored for the four numeric variables in `iris` (sepal width and length, petal width and length) and `penguins` (flipper length, body mass, bill length and depth) (Figure X A,B). 


```{r, warning = FALSE, message = FALSE, echo = FALSE, fig.align = "center"}
penguins %>%
  select(species, where(is.numeric)) %>% 
  ggpairs(aes(color = species, shape = species),
          columns = c("flipper_length_mm", "body_mass_g", 
                      "bill_length_mm", "bill_depth_mm"),
          columnLabels = c("Flipper length (mm)","Body mass (g)", "Bill length (mm)", "Bill depth (mm)"),
          upper = list(continuous = wrap("cor", size = 3))) +
  scale_fill_manual(values = c("darkorange","purple","cyan4")) +
  scale_color_manual(values = c("darkorange","purple","cyan4")) +
  scale_shape_manual(values = c(15,16,17)) +
  theme_minimal() +
  theme(
        text = element_text(size = 10, family = "Arial"),
        panel.grid.major = element_line(colour = NA),
        panel.grid.minor = element_blank(),
        panel.border = element_rect(color = "gray80", fill = NA)
        )

ggsave(here("figures","penguins_ggpairs.png"), height = 5, width = 9)

iris %>%
  ggpairs(aes(color = Species),
          columns = c("Petal.Length", "Petal.Width", 
                      "Sepal.Length", "Sepal.Width"),
          columnLabels = c("Petal length (cm)","Petal width (cm)", "Sepal length (cm)", "Sepal width (cm)"),
          upper = list(continuous = wrap("cor", size = 3))) +
  scale_colour_manual(values = c("darkorange","purple","cyan4")) +
  scale_fill_manual(values = c("darkorange","purple","cyan4")) +
  theme_minimal() +
  theme(
        text = element_text(size = 10, family = "Arial"),
        panel.grid.major = element_line(colour = NA),
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "gray90", color = "gray90")
        )

ggsave(here("figures","iris_ggpairs.png"), height = 5, width = 9)

```

## Linear correlation & regression

As seen in Figures (X,X) there are a number of opportunities to explore linear relationships and correlations in both `penguins` and `iris`. Here, we point out one comparison that is uniquely similar: 
petal dimensions (petal length versus petal width) from `iris`, and penguin size (flipper length versus body mass) in `penguins` (Figure X). We see that the overall trend across species is relatively linear for both `iris` and `penguins` (Figure X A,B). Teachers may encourage students explore how results of regression performed across all three species of iris or penguins (Figure X A,B) compare to results for regression performed within species (Figure X C,D).

Notably, distinctions between species are clearer for `iris` petals - particularly, the much smaller petals for *Iris setosa* - compared to `penguins`, in which Adélie and chinstrap penguins are largely overlapping in body size (body mass and flipper length), and are both generally smaller than gentoos. This difference is revisited in the k-means clustering example below. 


```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.align = "center"}

penguin_flip_mass_scatter <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_point(aes(color = species, shape = species), size = 1.5, alpha = 0.5) +
  geom_smooth(method = "lm", aes(group = species, color = species), se = FALSE, show.legend = FALSE) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = "bottom") +
  labs(x = "Flipper length (mm)", 
       y = "Body mass (g)") +
  theme(plot.title.position = "plot",
        panel.border = element_rect(fill = NA, color = "gray70"))

penguin_flip_mass_scatter_all <- ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_point(color = "gray50", size = 1.5, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  theme_minimal() +
  labs(x = "Flipper length (mm)", 
       y = "Body mass (g)") +
  theme(plot.title.position = "plot",
        panel.border = element_rect(fill = NA, color = "gray70"))

iris_petal_scatter <- ggplot(iris, aes(x = Petal.Length, y = Petal.Width)) +
  geom_point(aes(color = Species, size = Species, shape = Species), size = 1.5, alpha = 0.5) +
  geom_smooth(aes(group = Species, color = Species), method = "lm", se = FALSE, show.legend = FALSE) +
  theme_minimal() +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme(legend.position = "bottom") +
  labs(x = "Petal length (cm)",
       y = "Petal width (cm)") +
  theme(plot.title.position = "plot",
        panel.background = element_rect(fill = "gray90", color = "gray90"))

iris_petal_scatter_all <- ggplot(iris, aes(x = Petal.Length, y = Petal.Width)) +
  geom_point(color = "gray50", size = 1.5, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  theme_minimal() +
  labs(x = "Petal length (cm)",
       y = "Petal width (cm)") +
  theme(plot.title.position = "plot",
        panel.background = element_rect(fill = "gray90", color = "gray90")) 

(penguin_flip_mass_scatter_all + iris_petal_scatter_all) / (penguin_flip_mass_scatter + iris_petal_scatter) + plot_annotation(tag_levels = 'A')

ggsave(here("figures","iris_penguins_scatter.png"), height = 6, width = 8)

# Simpson's Paradox example (bill dimensions)
simpson_nospecies <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_point(color = "gray40", alpha = 0.6, size = 2) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  theme_minimal() +
  theme(panel.border = element_rect(fill = NA, color = "gray70")) +
  labs(x = "Bill length (mm)", y = "Bill depth (mm)")

simpson_wspecies <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm, group = species)) +
  geom_point(aes(color = species, shape = species), size = 2, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, aes(color = species)) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4")) +
  theme_minimal() +
  theme(panel.border = element_rect(fill = NA, color = "gray70"),
        legend.position = c(0.16,0.14)) +
  labs(x = "Bill length (mm)", y = "Bill depth (mm)")

simpson_gg <- (simpson_nospecies | simpson_wspecies) + plot_annotation(tag_levels = 'A')

simpson_gg

ggsave(here("figures","simpson_gg.png"), width = 8, height = 4)
```

## Hypothesis testing

Opportunities for hypothesis tests are similar using the four continuous quantitative variables in `penguins` and `iris`. Here, we describe replacement options for teachers currently using `iris` means comparisons using t-tests and one-way analysis of variance (ANOVA). 

### Two-sample t-tests

TODO

### One-way analysis of variance (ANOVA)

TODO

## Principal components analysis

The `iris` dataset appears frequently in examples for multivariate analyses, including principal component analysis (PCA). PCA is a dimensional reduction method that can be useful in capturing as much information about patterns in multivariate data as possible in a reduced number of dimensions (e.g., 2-dimensions for visualization). PCA with `iris` yields intuitive PC outcomes and clear clustering (Figure X) helpful for learners, as described in detail by others (ref, ref). 

PCA with `penguins` reveals a similar outcome (Figure X): two somewhat overlapping species (Adélie and Chinstrap) with one clearly separated (Gentoo), and intuitive loadings that can be related to scatterplots in Figure X. Percent of total variance captured by the first and second principal components are very similar between `iris` and `penguins` (Figure X). 

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.align = "center"}
# Copied from Alison Hill's post! 

### PENGUINS PCA: 
penguin_recipe <-
  recipe(~., data = penguins) %>% 
  update_role(species, island, sex, new_role = "id") %>% 
  step_naomit(all_predictors()) %>% 
  step_normalize(all_predictors()) %>%
  step_pca(all_predictors(), id = "pca") %>% 
  prep()

penguin_pca <- 
  penguin_recipe %>% 
  tidy(id = "pca") 

penguin_percvar <- penguin_recipe %>% 
  tidy(id = "pca", type = "variance") %>% 
  dplyr::filter(terms == "percent variance") 

# penguin_pca

# Biplot: 

# get pca loadings into wider format
pca_wider <- penguin_pca %>% 
  tidyr::pivot_wider(names_from = component, id_cols = terms)

# define arrow style:
arrow_style <- arrow(length = unit(.05, "inches"),
                     type = "closed")

# Make the biplot:
pca_plot <-
  juice(penguin_recipe) %>%
  ggplot(aes(PC1, PC2)) +
  geom_point(aes(color = species, shape = species), 
             alpha = 0.5, 
             size = 2) +
  scale_colour_manual(values = c("darkorange","purple","cyan4")) 

penguins_biplot <- pca_plot +
  geom_segment(data = pca_wider,
               aes(xend = PC1, yend = PC2), 
               x = 0, 
               y = 0, 
               arrow = arrow_style) + 
  geom_shadowtext(data = pca_wider,
            aes(x = PC1, y = PC2, label = terms), 
            nudge_x = c(0.7,0.7,1.7,1.2), 
            nudge_y = c(-0.1,-0.2,0.1,-0.1),
            size = 4, 
            color = "black",
            bg.color = "white") +
  theme(legend.position = "bottom",
        panel.border = element_rect(color = "gray70", fill = NA))

# For positioning (above): 
# 1: bill_length
# 2: bill_depth
# 3: flipper length
# 4: body mass

penguin_screeplot <- penguin_percvar %>% 
  ggplot(aes(x = component, y = value)) + 
  geom_col(fill = "gray50") + 
  scale_x_continuous(limits = c(0, 5), expand = c(0,0)) + 
  scale_y_continuous(limits = c(0,100), expand = c(0,0)) +
  ylab("% of total variance") +
  geom_text(aes(label = round(value,2)), vjust=-0.25) +
  theme(panel.border = element_rect(color = "gray70", fill = NA))

### IRIS PCA: 
iris_recipe <-
  recipe(~., data = iris) %>% 
  update_role(Species, new_role = "id") %>% 
  step_normalize(all_predictors()) %>%
  step_pca(all_predictors(), id = "pca") %>% 
  prep()

iris_pca <- 
  iris_recipe %>% 
  tidy(id = "pca") 

# Biplot: 

# get pca loadings into wider format
iris_wider <- iris_pca %>% 
  tidyr::pivot_wider(names_from = component, id_cols = terms)

# define arrow style:
arrow_style <- arrow(length = unit(.05, "inches"),
                     type = "closed")

# Make the biplot:
iris_pca_plot <-
  juice(iris_recipe) %>%
  ggplot(aes(PC1, PC2)) +
  geom_point(aes(color = Species, shape = Species), 
             alpha = 0.5, 
             size = 2) +
  scale_colour_manual(values = c("darkorange","purple","cyan4")) 

iris_biplot <- iris_pca_plot +
  geom_segment(data = iris_wider,
               aes(xend = PC1, yend = PC2), 
               x = 0, 
               y = 0, 
               arrow = arrow_style) + 
  geom_shadowtext(data = iris_wider,
            aes(x = PC1, y = PC2, label = terms), 
            nudge_x = c(0.5,0.3,1,1.2), 
            nudge_y = c(-0.1,-0.2,0.1,-0.1),
            size = 4, 
            color = "black",
            bg.color = "white") +
  theme(panel.background = element_rect(fill = "gray90", color = "gray90"),
        legend.position = "bottom")

iris_percvar <- iris_recipe %>% 
  tidy(id = "pca", type = "variance") %>% 
  dplyr::filter(terms == "percent variance")

iris_screeplot <- iris_percvar %>% 
  ggplot(aes(x = component, y = value)) + 
  geom_col(fill = "gray50") + 
  scale_x_continuous(limits = c(0, 5), expand = c(0,0)) + 
  scale_y_continuous(limits = c(0,100), expand = c(0,0)) +
  ylab("% of total variance") +
  geom_text(aes(label = round(value,2)), vjust=-0.25) +
  theme(panel.background = element_rect(fill = "gray90", color = "gray90"))

(penguins_biplot | iris_biplot) / (penguin_screeplot | iris_screeplot) + plot_annotation(tag_levels = 'A')

ggsave(here("figures","pca_plots.png"), width = 8, height = 8)
```

## K-means clustering

Unsupervised clustering by k-means is a common and popular entryway to machine learning and classification, and frequently employs the `iris` data for introductory examples (refs). The `penguins` data provides similar opportunities for demonstrating, and illustrating limitations of, k-means clustering. 

Here, we compare k-means clustering using only two variables for each dataset: for `iris`, petal width and petal length, and for `penguins`, bill length and bill depth. All included variables are scaled prior to k-means by Z-score standardization. Three clusters (*k* = 3) are specified for each since there are three species of both *Iris* (*setosa*, *versicolor*, and *virginica*) and penguins (Adélie, chinstrap and gentoo).

K-means with `penguins` and `iris` bill and petal dimensions, respectively, yields largely distinct clusters each dominated by one species (Figure X, Table X). 

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.align = "center"}
# TWO VARIABLE k-means comparison
# Penguins: Bill length vs. bill depth
# Iris: petal length vs. petal width

p_bills <- penguins %>% 
  select(species, bill_length_mm, bill_depth_mm) %>% 
  drop_na()

p_bills_nospecies <- p_bills %>% 
  select(-species) %>% 
  scale() %>% 
  as.data.frame()

# Perform k-means on penguin bill dimensions (k = 3, w/20 centroid starts)
p_bills_kmeans <- kmeans(p_bills_nospecies, centers = 3, nstart = 20)

# Bind clusters to the data
p_kmeans_clusters <- cbind(p_bills_nospecies, cluster = as.factor(p_bills_kmeans$cluster), species = p_bills$species)

# Plot clusters
p_kmeans_gg <- ggplot(p_kmeans_clusters, aes(x = bill_length_mm, y = bill_depth_mm)) +
  geom_text(aes(label = cluster, color = species)) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4"))

# Get counts in each cluster by species
p_cluster_counts <- p_kmeans_clusters %>% 
  count(species, cluster) %>% 
  pivot_wider(names_from = species, values_from = n) %>% 
  arrange(cluster)

```

```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.align = "center"}

iris_petals <- iris %>% 
  select(Species, Petal.Length, Petal.Width)

# remove species factor & scale petal dimensions: 
ip_nospecies <- iris_petals %>% 
  select(-Species) %>% 
  scale() %>% 
  as.data.frame()

# Perform k-means on iris petal dimensions (k = 3, w/20 centroid starts)
set.seed(1967)
ip_kmeans <- kmeans(ip_nospecies, centers = 3, nstart = 20)

# Bind clusters to the data
iris_kmeans_clusters <- cbind(ip_nospecies, cluster = as.factor(ip_kmeans$cluster), species = iris$Species)

# Plot clusters: 
iris_kmeans_gg <- ggplot(iris_kmeans_clusters, aes(x = Petal.Length, y = Petal.Width)) +
  geom_text(aes(label = cluster, color = species)) +
   theme(legend.position = "bottom",
         panel.background = element_rect(fill = "gray92", color = "gray90")) +
  scale_color_manual(values = c("darkorange","darkorchid","cyan4"))

# Get counts in each cluster by species
iris_cluster_counts <- iris_kmeans_clusters %>% 
  count(species, cluster) %>% 
  pivot_wider(names_from = species, values_from = n) %>% 
  arrange(cluster)
```

```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.align = "center"}
(p_kmeans_gg | iris_kmeans_gg) + plot_annotation(tag_levels = "A")

kmeans_2var_table <- cbind(p_cluster_counts, iris_cluster_counts) %>% 
  kable() %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(c(5:8), background = "gainsboro") %>% 
  add_header_above(c("Penguins cluster assignments" = 4, "Iris cluster assignments" = 4))

kmeans_2var_table
```

## Machine learning (species classification)

# Conclusion

Through side-by-side comparisons of data structure, size, and analysis outcomes, we have shown that the Palmer Archipelago penguins dataset can serve as a direct replacement for `iris` for many use cases in statistics education. 

# Acknowledgements

We would like to thank the following people for their contributions: Marty Downs (NCEAS) for help with the Palmer Archipelago penguins data access and license information, Dr. Julien Brun (NCEAS) for code to directly import the data from EDI into *R*, and Dr. Hadley Wickham for contributions to the **palmerpenguins** package. [Just a placeholder - any updates / additions / changes go ahead & add...]

# Appendix

## Appendix A: Variables in the raw data

- **studyName:** Sampling expedition indicator
- **Sample Number:** Integer denoting the continuous numbering sequence for each penguin
- **Species:** a factor denoting the penguin species (Adelie, Chinstrap, or Gentoo)
- **Region**: A character denoting the region of the Palmer LTER sampling grid
- **Island:** a factor denoting the island where observed (Torgersen, Dream or Biscoe) in Palmer Archipelago
- **Stage:** A character string denoting reproductive stage at sampling
- **Individual ID:** A character string denoting a unique ID for each penguin
- **Clutch Completion:** A character string denoting if the study next observed with a full clutch, i.e. 2 eggs
- **Date Egg:** A date denoting the date study nest observed with 1 egg
- **Culmen Length:** A number denoting the length of the dorsal ridge of a bird's bill (millimeters)
- **Culmen Depth:** A number denoting the depth of the dorsal ridge of a bird's bill (millimeters)
- **Flipper Length:** An integer denoting the penguin flipper length (millimeters)
- **Body Mass:** An integer denoting the penguin body mass (grams)
- **Sex:** A character string denoting the sex of an animal
- **Delta 15 N:** A number denoting the measure of the ratio of stable isotopes 15N:14N
- **Delta 13 C:** A number denoting the measure of the ratio of stable isotopes 13C:12C
- **Comments:** A character string with text providing additional relevant information for data

# Citations

